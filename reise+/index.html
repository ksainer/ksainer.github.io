<!DOCTYPE html>
<html lang="ru">

<head>
	<meta charset="UTF-8">
	<meta name="keywords" content="запчасти автомобили audi bmw volvo skoda mazda nissan toyota kia hyndai">
	<meta name="description" content="Продажа запчастей и электроники в наличии и под заказ">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Reise+</title>
	<link rel="stylesheet" href="style.css">
</head>

<body>
	<main class="main-page">
		<div class="wrapper">
			<header class="main-page__header">
				<section class="logo-section">
					<a href="#">
						<img src="img/logo.png" alt="logo" class="logo-section__img">
					</a>
					<p class="logo-section__text">
						Продажа запчастей и электроники в наличии и под заказ.
					</p>
				</section>

				<section class="contacts">
					<p class="contacts__call-text">Звоните:</p>
					<a href="tel:+78202629122" class="contacts__phone">+7(8202)62-91-22</a>
					<p class="contacts__opening-hours">Работаем с 9:00 до 19:00</p>
					<p class="contacts__location">Мы находимся на:</p>
					<p class="contacts__location">ул. Краснодонцев, 1</p>

					<button class="contacts__button button">
						<span class="button__text">
							Позвоните нам бесплатно
						</span>
					</button>
				</section>
			</header>

			<h1 class="main-page__title title">
				Запчасти и электроника на любые автомобили
			</h1>

			<section class="middle-section">

				<div class="auto-labels">
					<div class="auto-labels__car-item"></div>
					<div class="auto-labels__car-item"></div>
					<div class="auto-labels__car-item"></div>
					<div class="auto-labels__car-item"></div>
					<div class="auto-labels__car-item"></div>
					<div class="auto-labels__car-item"></div>
					<div class="auto-labels__car-item"></div>
					<div class="auto-labels__car-item"></div>
					<div class="auto-labels__car-item"></div>
					<div class="auto-labels__car-item"></div>
					<div class="auto-labels__car-item"></div>
					<div class="auto-labels__car-item"></div>
				</div>

				<div class="form-cb">
					<h3 class="form-cb__title title">Оставьте заявку сейчас!</h3>
					<form action="mailto:gksainer@gmail.com" method="POST">
						<fieldset class="form-cb__fieldset">
							<p class="form-cb__text">Введите данные для подбора, Ваш телефон или e-Mail. Через час Мы сообщим
								Вам стоимость и срок поставки Вашего заказа!</p>

							<textarea name="date-order" class="form-cb__textarea"
								placeholder='Например: Ступица колеса Hyundai Solaris хэтчбэк 1.6 2011'></textarea>
							<p class="form-cb__label">Заказ</p>

							<div class="form-cb__costomer-contacts">
								<label class="form-cb__label">
									<input type="tel" class="form-cb__input form-cb__phone" placeholder="+7 (999) 999-99-99"
										required pattern="\+7\s\(9[0-9]{2}\)\s[0-9]{3}-[0-9]{2}-[0-9]{2}"><br>
									Телефон
								</label>
								<label class="form-cb__label">
									<input type="email" class="form-cb__input" placeholder="email@address.ru" required><br>
									e-Mail
								</label>
							</div>

							<button class="button">
								<span class="form-cb__btn-text button__text">
									Оставить заявку прямо сейчас!
								</span>
							</button>

							<p class="form-cb__notice">Заполнение заявки Вас ни к чему не обязывает!</p>
							<p class="form-cb__notice">Вы сможете отзаться в любой момент!</p>
						</fieldset>
					</form>
				</div>

			</section>

		</div>
	</main>
	<script src="js/jquery-3.4.1.min.js"></script>
	<script src="js/jquery.mask.min.js"></script>
	<script>
		'use strict';
	// 	$(document).ready(function(){
	// 	$('.form-cb__phone').mask('+7 (000) 000-00-00');
	// });

		$(document).ready(function () {
			$('.form-cb__phone').keydown(function (event) {
				let v = $(this).val();
				console.log(event.target.selectionStart, event.keyCode, $(this), event);

				if (event.keyCode >= 35 && event.keyCode <= 40 ||
					event.keyCode >= 112 && event.keyCode <= 123 ||
					event.ctrlKey || [8, 9, 13, 46].some(el => el === event.keyCode)) {
					// 8 -> backspace
					// 9 -> tab
					// 13 -> enter
					// 35 -> home
					// 36 -> end
					// 37 - 40 -> стрелки
					// 46 -> del
					// 112 - 123 -> F1-F12
					// let noDelSymbols = [')', ' ', '-'];
					// if (event.keyCode === 8 &&
					// 	(noDelSymbols.some(el => el === v[event.target.selectionStart - 1]) ||
					// 		event.target.selectionStart < 5)) {
					// 	event.preventDefault();
					// 	if (event.target.selectionStart)
					// 		$(this)[0].selectionEnd -= 1;
					// }
					// if (event.keyCode === 46 &&
					// 	(noDelSymbols.some(el => el === v[event.target.selectionStart]) ||
					// 		event.target.selectionStart < 4)) {
					// 	event.preventDefault();
					// }


				} else if ((v.length < $(this)[0].placeholder.length) &&
					(event.keyCode >= 48 && event.keyCode <= 57 && !event.shiftKey ||
						event.keyCode >= 96 && event.keyCode <= 105) ||
					v.length === 0 && event.keyCode == 187 && event.shiftKey) {
					// цифры без shift (48 - 57)
					// num-цифры (96 - 105)
					let savePos = event.target.selectionStart;
					if (v.length === 7 && !~v.indexOf(') ')) {
						v += ') ' + event.key;
						savePos = v.length;
						console.log('catch 1');
					} else if (v.length === 12 && !~v.indexOf('-')) {
						
						v += '-' + event.key;
						savePos = v.length;
						console.log('catch2');
					} else if (v.length === 15 && !~v.indexOf('-', v.indexOf('-') + 1)) {
						v += '-' + event.key;
						savePos = v.length;
						console.log('catch3');
					} else if (event.target.selectionStart < v.length && event.target.selectionStart > 4) {
						v = v.slice(0, event.target.selectionStart) + event.key + v.slice(event.target.selectionStart);
						savePos = event.target.selectionStart + 1;
						console.log('catch4');
					} 
					if (v != $(this).val()) {
						$(this).val(v);
						$(this)[0].selectionEnd = savePos;

						event.preventDefault();
					} 



					// else {
					// 	let pos = event.target.selectionStart;
					// 	console.log(pos, event.target.selectionEnd);
					// 	v = v.slice( 0, v[4]) + event.key + v.slice(v[4]);
					// 	console.log('catch5');
					// }

					
				} else {
					event.preventDefault()
				};

			}).keyup(function () {
				let v = $(this).val();
				// +7 (000) 000-00-00
				// 012345678901234567
				// console.log('33333')
				if (v.length <= 4 && v != '+7 (') {
					v = '+7 (';
				} 
				// else if (v.lenght < 10) {
				// 	console.log('111')
				// 	if (~v.indexOf(') '))
				// 		v = v.slice(0, v.indexOf(') '));
				// } 
				// else if ( v.slice( v.indexOf('('), v.indexOf(')') ).length < 3 ) {
				// 	v = v.slice( 0, v.indexOf(')') ) + v.slice( v.indexOf(')') + 2 );
				// 	v = v.slice( 0, 7 ) + ') ' + v.slice ( 7 );
				// }

				$(this).val(v);
				
				// if (~v.indexOf(') ') && v.slice(v.indexOf('('), v.indexOf(') ')).length < 3) {

				// 	if (v.length > 9) {
				// 		v = v.slice(0, v.indexOf(') ')) + v.slice(v.indexOf(') ') + 2);
				// 		v = v.slice(0, 7) + ') ' + v.slice(7);
				// 		console.log('opa');
				// 	} else {
				// 		v = v.slice(0, v.indexOf(') ')) + + v.slice(v.indexOf(') ') + 2, v.indexOf(') ') + 3);
				// 		console.log('??')
				// 	} 

				// 	let savePos = event.target.selectionStart;
				// 	$(this).val(v);
				// 	$(this)[0].selectionEnd = savePos;

				// } 
				// if (~v.indexOf('-') ) {
				// 	console.log('opa2');
				// }

				// else if (v.slice(0, 4) != '+7 (') {
				// 	let arrVal = v.split('');
				// 	arrVal[0] = '+';
				// 	arrVal[1] = '7';
				// 	arrVal[2] = ' ';
				// 	arrVal[3] = '(';
				// 	$(this).val(arrVal.join(''));
				// }
			}).focus(function () {
				if ($(this).val().length < 4) {
					$(this).val('+7 (');
				}
			}).focusout(function () {
				if ($(this).val().length < 5) {
					$(this).val('');
				}
			});
		});
	</script>
</body>

</html>